<?php

use PHPUnit\Framework\TestCase;
use jpuck\avhost\Core\Utils\Signature;

class SignatureTest extends TestCase
{
    public function test_can_instantiate_object()
    {
        $this->assertInstanceOf(Signature::class, new Signature);
    }

    public function test_can_get_signature_string()
    {
        $version = getenv('AVHOST_VERSION_NUMBER');

        $datetime = date('c');

        $user = trim(`whoami`) . '@' . gethostname();

        $expected = <<<SIGNATURE
##########################################
# Generated by avhost
# https://github.com/jpuck/avhost
# version $version
# created at $datetime
# created by $user
##########################################

SIGNATURE;

        $actual = (new Signature)->render();

        $this->assertSame($expected, $actual);
    }

    public function test_can_import_and_export_array()
    {
        $expected = [
            'version' => '1.0.1',
            'created at' => '2017-11-24T21:56:15+00:00',
            'created by' => 'jeff@xervo',
        ];

        $signature = Signature::createFromArray($expected);

        $actual = $signature->toArray();

        $this->assertEquals($expected, $actual);
    }
}
